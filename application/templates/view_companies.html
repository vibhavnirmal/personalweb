{% extends "layout.html" %}

{% block content %}

<div class="container-fluid mt-4">

    <div class="container">
        <div class="row justify-content-between mb-4">
            <div>
                <a href="{{ url_for('my_companies.add_company') }}" class="btn btn-success float-left">
                    <i class="bi bi-plus-circle"></i>
                    &nbsp;Add Company
                </a>
            </div>
            <div class="text-center">
                <h4>Tracked Companies</h4>
            </div>
        </div>
    </div>
    

    <div class="table-responsive">
        <table id="example" class="table table-striped align-middle" style="width:100%">
            <thead>
                <tr>
                    <th>Company name</th>
                    <th>Career Link</th>
                    <th>Applications</th>
                    <th>City</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>

            <tbody>
                {% for file in files %}
                {% if file.deleted == false %}
                <tr>
                    <td>
                        {% if file.website %}
                            <a href="{{ file.website | default('#', true) }}" target="_blank">{{ file.company_name }}</a>
                        {% else %}
                            {{ file.company_name }}
                        {% endif %}
                    </td>
                        
                    <td>
                        {% if file.careers_page %}
                            <a href="{{ file.careers_page }}" target="_blank">
                                {{ '<i class="bi-box-arrow-up-right"></i>'|safe }}
                            </a>
                        {% else %}
                        {{ '<i class="bi-box-arrow-up-right"></i>'|safe }}
                        {% endif %}
                    </td>

                    <td>
                        {% if applications.get(file.company_name, 0) > 0 %}
                            {{ applications.get(file.company_name) }}
                            <a href="{{ url_for('my_applications.view_applications', company_name=file.company_name) }}">
                                <button class="btn btn-secondary btn-sm" type="button" id="viewApplications">
                                    {{ '<i class="bi-eye"></i>'|safe }}
                                </button>
                            </a>
                        {% else %}
                            0
                        {% endif %}
                    </td>

                    <td id="city">{{ file.location|default('Not available', true) }}</td>

                    <td>
                        <a href="{{ url_for('my_companies.edit_company', id=file.id) }}">
                            <button class="btn btn-primary btn-sm" type="button" id="editCompany">
                                {{ '<i class="bi-pencil-square"></i>'|safe }}
                            </button>
                        </a>    
                    </td>
                    <td>
                        <a href="{{ url_for('my_companies.delete_company', id=file.id) }}">
                            <button class="btn btn-danger btn-sm" type="button" id="deleteCompany">
                                {{ '<i class="bi-trash"></i>'|safe }}
                            </button>
                        </a>
                    </td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>

        </table>
    </div>

</div>

<script src="https://code.jquery.com/jquery-3.7.0.js"></script>

{% endblock %}
